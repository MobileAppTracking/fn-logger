!function(exports,global){global["true"]=exports;var application=angular.module("fn.logger",[]);angular.module("fn.logger").provider("logDB",function(){var a=[],b=[],c=this;this.init=angular.noop(),this.create=function(b){return a.push(b),!0},this.read=function(c){return b=_.filter(a,function(a){for(var b in c)if(!_.contains(c[b],a[b]))return!1;return!0}),b=_.sortBy(b,"time")},this.update=function(b,c){return _.each(a,function(a){a.id==b&&(a=_.extend(a,c))}),!0},this.delete=function(){return _.each(b,function(b){a.splice(_.indexOf(a,b),1)}),!0},this.getNameSpaces=function(){var b=_.pluck(a,"namespace");return _.uniq(b)},this.$get=function(){return c}}),angular.module("fn.logger").config(["$provide","logDBProvider",function(a,b){"use strict";var c;a.decorator("$sce",["$delegate",function(a){return c=a}]),a.decorator("$log",["$delegate",function(a){var d=window.console||{},e={error:d.error,info:d.info,warn:d.warn,log:d.log},f=0,g=function(){return f++};a.interceptConsole=function(){_.each(["error","info","warn","log"],function(b){d[b]=function(){a[b].apply(a,_.union(["console"],_.toArray(arguments)))}})},a.stopInterceptingConsole=function(){_.each(["error","info","warn","log"],function(a){d[a]=function(){e[a].apply(d,arguments)}})},a.consoleEnabled=["error","info","warn","log"],a.dbEnabled=["error","info","warn","log"],a.datastore=b;var h=function(a){if(a instanceof Error){if(a.stack)return a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack;if(a.sourceURL)return a.message+"\n"+a.sourceURL+":"+a.line}return"string"==typeof a?a.replace(/\\n/g,"\n"):a},i=function(a){if(a instanceof Error){if(a.stack){var b=a.stack.split("\n");return!a.message||a.message&&-1!==b[0].indexOf(a.message)?b[0]:a.message}if(a.sourceURL)return a.message+"\n"+a.sourceURL+":"+a.line}return a},j={key:"<span class=json-key>",val:"<span class=json-value>",str:"<span class=json-string>",replacer:function(a,b,c,d,e){var f=b||"";return c&&(f=f+j.key+c.replace(/[": ]/g,"")+"</span>: "),d&&(f=f+('"'==d[0]?j.str:j.val)+d+"</span>"),f+(e||"")},prettyPrint:function(a){var b=/^( *)("[\w]+": )?("[^"]*"|[\w.+-]*)?([,[{])?$/gm,c=JSON.stringify(JSON.decycle(a),null,2);return _.isString(c)?c.replace(/\\n/g,"\n").replace(/&/g,"&amp;").replace(/\\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(b,j.replacer):"undefined"}},k=function(a){var b=[];return _(a).each(function(a){var d;d=a instanceof jQuery?{data:a.html(),type:"html"}:{data:j.prettyPrint(a),type:"code"},c&&(d.data=c.trustAsHtml(d.data)),b.push(d)}),b};return _.each(["error","info","warn","log"],function(b){a[b]=function(c,f){var j=_.toArray(arguments),l=!1;if(_.isUndefined(f)&&(j[1]=f=c,j[0]=c="default"),_.each(j,function(a,b){1===b&&a instanceof Error?(j[b]=f=i(a),j.push(h(a))):(l=a instanceof jQuery?!0:l,j[b]=h(a))}),_.isObject(f)&&(f=h(JSON.stringify(JSON.decycle(f)))),_.contains(a.consoleEnabled,b)){var m,n=e[b]||e.log||angular.noop;n.apply&&(m=_.clone(j),l&&_.each(m,function(a,b){if(a instanceof jQuery){var c=a.text().replace(/\n^\s*\n/gm,"\n");m[b]=c.length>80?c.slice(0,80)+"...":c}}),_(["default","console"]).contains(c)&&(m=m.splice(1)),n.apply(d,m))}if(_.contains(a.dbEnabled,b)){if(_.isNull(a.datastore))return;j=j.splice(2);var o={id:g(),namespace:c,level:b,time:new Date,message:f},p=_.clone(o);return p.extra=k(j),a.datastore.create(p),o.data=j,o}}}),a.update=function(b){!_.isNull(a.datastore)&&_.has(b,"level")&&_.has(b,"id")&&_.contains(a.dbEnabled,b.level)&&(b.time=new Date,b.extra=k(b.data),a.datastore.update(b.id,b))},a.clear=function(){_.isNull(a.datastore)||a.datastore.delete()},a.getNamespaces=function(){return null==a.datastore?[]:a.datastore.getNameSpaces()},a.getLogger=function(b){var c={};return _.each(["error","info","warn","log"],function(d){c[d]=function(){var c=[b].concat([].splice.call(arguments,0));a[d].apply(a,c)}}),c},a.getLogs=function(b,c,d){var e={};_.isEmpty(b)||(e.namespace=b),_.isEmpty(c)||(e.level=c),_.isEmpty(d)||(e.message=d);var f=a.datastore.read(e);return f},a.interceptConsole(),window.$log=a,a}])}]),"function"!=typeof JSON.decycle&&(JSON.decycle=function(a){"use strict";var b=[],c=[];return function d(a,e){var f,g,h;if(!("object"!=typeof a||null===a||a instanceof Boolean||a instanceof Date||a instanceof Number||a instanceof RegExp||a instanceof String)){for(f=0;f<b.length;f+=1)if(b[f]===a)return{$ref:c[f]};if(b.push(a),c.push(e),"[object Array]"===Object.prototype.toString.apply(a))for(h=[],f=0;f<a.length;f+=1)h[f]=d(a[f],e+"["+f+"]");else{h={};for(g in a)Object.prototype.hasOwnProperty.call(a,g)&&(h[g]=d(a[g],e+"["+JSON.stringify(g)+"]"))}return h}return a}(a,"$")}),"function"!=typeof JSON.retrocycle&&(JSON.retrocycle=function retrocycle($){"use strict";var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;return function rez(value){var i,item,name,path;if(value&&"object"==typeof value)if("[object Array]"===Object.prototype.toString.apply(value))for(i=0;i<value.length;i+=1)item=value[i],item&&"object"==typeof item&&(path=item.$ref,"string"==typeof path&&px.test(path)?value[i]=eval(path):rez(item));else for(name in value)"object"==typeof value[name]&&(item=value[name],item&&(path=item.$ref,"string"==typeof path&&px.test(path)?value[name]=eval(path):rez(item)))}($),$}),application.directive("debugger",["$log","$timeout",function(a,b){"use strict";return{templateUrl:"/src/logger/debugger.html",restrict:"E",transclude:!0,"replace ":!0,scope:!0,controller:["$scope","$document",function(c,d){var e=!1;try{localStorage.setItem("storage",""),localStorage.getItem("storage"),localStorage.removeItem("storage"),e=!0}catch(f){}var g=function(){b(function(){var b=_.contains(c.activeNamespaces,"_all")?null:c.activeNamespaces,d=_.contains(c.activeLevels,"_all")?null:c.activeLevels,f=[];c.searchTerm&&f.push(c.searchTerm),c.logs=a.getLogs(b,d,f),e&&(localStorage.setItem("activeNamespaces",JSON.stringify(c.activeNamespaces)),localStorage.setItem("activeLevels",JSON.stringify(c.activeLevels)))})};if(c.logs=[],c.activeNamespaces=["_all"],c.activeLevels=["_all"],c.namespaces=a.getNamespaces(),c.levels=a.dbEnabled,e)try{c.activeLevels=JSON.parse(localStorage.getItem("activeLevels"))||c.activeLevels,c.activeNamespaces=JSON.parse(localStorage.getItem("activeNamespaces"))||c.activeNamespaces,c.namespaces=_.without(_.union(c.activeNamespaces,c.namespaces),"_all")}catch(h){c.activeNamespaces=["_all"],c.activeLevels=["_all"]}c.clear=function(){a.clear(),g()},c.search=function(){g()},c.setActiveNamespace=function(a){"_all"==a?c.activeNamespaces=["_all"]:(_.contains(c.activeNamespaces,a)?c.activeNamespaces=_.without(c.activeNamespaces,a):c.activeNamespaces.push(a),c.activeNamespaces=_.without(c.activeNamespaces,"_all")),0===c.activeNamespaces.length&&(c.activeNamespaces=["_all"]),g()},c.setActiveLevel=function(a){"_all"==a?c.activeLevels=["_all"]:(_.contains(c.activeLevels,a)?c.activeLevels=_.without(c.activeLevels,a):c.activeLevels.push(a),c.activeLevels=_.without(c.activeLevels,"_all")),0===c.activeLevels.length&&(c.activeLevels=["_all"]),g()},c.toggleActive=function(a){"code"!=a.target.nodeName.toLowerCase()&&0===$(a.target).parents("code").length&&angular.element(a.currentTarget).toggleClass("active")},c.namespaceClass=function(a){return _.contains(c.activeNamespaces,a)?"debugger-check":"debugger-check-empty"},c.levelClass=function(a){return _.contains(c.activeLevels,a)?"active "+a:a},g();var i,j,k=!1,l=$("#debugger"),m=175;e&&(m=localStorage.getItem("debuggerHeight")||m),m>$(window).height()-50&&(m=$(window).height()-50),j=function(a){$("body").css("padding-bottom",a+"px"),l.height(a),e&&localStorage.setItem("debuggerHeight",a)},j(m),l.find(".toggler").click(function(){k||(l.height()>8?(i=l.height(),j(8)):j(i||200))}),d.on("mousedown",".resizer",function(a){a.preventDefault();var b=a.clientY||a.PageY,c=l.height();d.bind("mousemove",function(a){k=!0;var e=c+(b-(a.clientY||a.PageY));0>e&&d.trigger("mouseup"),e=e>8?e:8,j(e)}),d.bind("mouseup",function(){setTimeout(function(){k=!1},50),d.unbind("mousemove"),d.unbind("mouseup")})});var n=$("#debugger .content"),o=$("#debugger .sidebar"),p=200,q=function(a){o.width(a).css("margin-left",-1*a),n.css("padding-left",a)};q(p),d.on("mousedown",".sidebar-resize",function(a){a.preventDefault();var b=a.clientX||a.PageX,c=o.width();d.bind("mousemove",function(a){k=!0;var e=c+((a.clientX||a.PageX)-b);0>e&&d.trigger("mouseup"),e=e>120?e:120,q(e)}),d.bind("mouseup",function(){setTimeout(function(){k=!1},50),d.unbind("mousemove"),d.unbind("mouseup")})})}]}}]),angular.module("fn.logger").run(["$templateCache",function(a){"use strict";a.put("/src/logger/debugger.html",'<div id="debugger"><div class="resizer toggler"><span id="newLogIndicator"></span></div><div class="content"><div class="sidebar"><h3>Namespaces</h3><ul><li ng-click="setActiveNamespace(\'_all\')"><i class="{{namespaceClass(\'_all\')}}"></i> All Namespaces</li><li ng-repeat="namespace in namespaces" ng-click="setActiveNamespace(namespace)"><i class="{{namespaceClass(namespace)}}"></i> {{namespace}}</li></ul><div class="sidebar-resize"></div></div><ul class="level-filter"><li ng-click="setActiveLevel(\'_all\')" class="{{levelClass(\'_all\')}}">All</li><li ng-repeat="level in levels" ng-click="setActiveLevel(level)" class="{{levelClass(level)}}">{{level}}</li><li ng-click="clear()" class="clear-data">Clear</li><li class="search-data">Search<input type="text" ng-keyup="search()" ng-model="searchTerm"></li></ul><ul class="logs"><li bindonce="" ng-repeat="log in logs" ng-click="toggleActive($event)" ng-class="{expandable : log.extra.length > 0}"><span class="level" ng-class="log.level" ng-bind="log.level"></span> <span class="time" ng-bind="log.time|date:\'mediumTime\'"></span> <span class="view-more" ng-show="log.extra.length"><span class="more">View More</span> <span class="less">View Less</span> <span class="disclosure-arrow">&#9663;</span></span> <span class="namespace" ng-bind="log.namespace"></span> <span class="message" ng-bind="log.message"></span><br style="clear: both"><code ng-repeat="data in log.extra" ng-class="{only_child : log.extra.length == 1 || ($index == log.extra.length-1 && $index % 2 == 0)}" ng-bind-html="data.data" class="{{data.type}}"></code></li></ul></div></div><style type="text/css">#debugger{-webkit-box-shadow:0 -3px 4px 0 rgba(0,0,0,.3);-moz-box-shadow:0 -3px 4px 0 rgba(0,0,0,.3);box-shadow:0 -3px 4px 0 rgba(0,0,0,.3);-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;background:rgba(255,255,255,.9);border-top:1px solid #888;bottom:0;height:175px;left:0;overflow:hidden;padding:10px 0 0;position:fixed;width:100%;z-index:9997}#debugger .error{background:#BA322E}#debugger .info{background:#2986C4}#debugger .warn{background:#ED9C24}#debugger .log{background:#8AC334}#debugger div,#debugger ul,#debugger li,#debugger h3,#debugger code,#debugger span{margin:0;padding:0;font-size:13px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}#debugger h3{text-rendering:optimizeLegibility;line-height:1.4}#debugger ul{list-style-type:none;line-height:1.6}#debugger code{background-color:#f5f5f5;border:1px solid rgba(0,0,0,.15);-moz-border-radius:4px;-webkit-border-radius:4px;border-radius:4px;color:#555;cursor:default;font-family:Consolas,"Liberation Mono",Courier,monospace;font-size:10px;line-height:11px;margin:10px 2% 0 0;padding:8px;white-space:pre;white-space:pre-wrap;width:49%;word-break:break-all;word-wrap:break-word;vertical-align:top}#debugger code.html{font-family:inherit;color:inherit}#debugger code:nth-child(2n){margin-right:0}#debugger code.only_child{width:100%;margin-right:0}#debugger #newLogIndicator{width:12px;height:12px;float:right;display:inline-block;border:1px solid rgba(0,0,0,0);-moz-border-radius:6px;-webkit-border-radius:6px;border-radius:6px;top:6px;position:relative;right:6px;-webkit-filter:blur(1px)}#debugger #newLogIndicator.log{border:solid 1px rgba(138,195,52,.85)}#debugger #newLogIndicator.warn{border:solid 1px rgba(237,156,36,.85)}#debugger #newLogIndicator.info{border:solid 1px rgba(82,156,207,.85)}#debugger #newLogIndicator.error{border:solid 1px rgba(237,69,38,.85)}#debugger .resizer{background-position:center;background-repeat:no-repeat;background-image:url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAFCAMAAACD1meMAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAGUExURbu7u////3iwjPUAAAACdFJOU/8A5bcwSgAAABRJREFUeNpiYMADGHEDBhroAwgwAA9QADeT0qnSAAAAAElFTkSuQmCC\');cursor:ns-resize;height:15px;margin:-13px auto 8px auto;z-index:9999}#debugger .sidebar{background:#E0DFDF;border-right:solid 1px #a6aab3;height:100%;overflow:scroll;padding:12px 0;position:relative;width:200px;float:left;margin-left:-200px;margin-top:-1px;border-top:solid 1px #B6B5B5}#debugger .sidebar-resize{display:inline-block;height:100%;position:absolute;top:0;right:0;cursor:ew-resize;width:4px}#debugger .sidebar h3{color:#535353;text-transform:uppercase;text-shadow:0 1px 0 #eceff6;font-size:14px;padding:0 12px 8px}#debugger .sidebar li:hover{color:#fff;text-shadow:0 1px #52315F;background:#89559C}#debugger .sidebar li{color:#4C4B4B;text-shadow:0 1px 0 #e8ebf0;text-transform:capitalize;padding:6px 12px;cursor:pointer}#debugger .sidebar li i{font-size:115%}#debugger .content{padding:0 0 0 200px;clear:right;position:relative;width:100%;height:100%;right:auto;float:left;background:#f4f4f4;border-top:solid 1px #B6B5B5}#debugger .logs{padding:0 14px 40px;height:100%;overflow-y:scroll;overflow-x:hidden;position:relative;margin-bottom:30px}#debugger .logs li{border-bottom:solid 1px #bbb;margin-bottom:8px;padding-bottom:8px;border-radius:4px;border:solid 1px #c8c8c8;background:#fefefe;box-shadow:0 0 5px 0 #dfdfdf;padding:8px;margin:10px 0}#debugger .logs li.expandable{cursor:pointer}#debugger .logs li code{display:none}#debugger .logs li.active code{display:inline-block}#debugger .logs li span{display:inline-block}#debugger .logs li .level{width:10%;color:#fff;text-align:center;font-size:11px;line-height:22px;position:relative;border-radius:4px;opacity:.3;top:-4px}#debugger .logs li .time{position:absolute;right:21px;margin-top:-7px;font-size:12px;color:#ccc}#debugger .logs li .view-more{position:absolute;right:21px;margin-top:11px;font-size:12px;color:#ccc}#debugger .logs li .view-more .more{display:inline-block}#debugger .logs li.active .view-more .more{display:none}#debugger .logs li .view-more .less{display:none}#debugger .logs li.active .view-more .less{display:inline-block}#debugger .logs li.active .disclosure-arrow{-webkit-transform:rotate(-180deg);-moz-transform:rotate(-180deg);-ms-transform:rotate(-180deg);-o-transform:rotate(-180deg);transform:rotate(-180deg)}#debugger .logs li .namespace{color:#999;width:11%;font-size:11px;line-height:22px;padding:0 0 0 6px;text-transform:capitalize;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}#debugger .debugger-check-empty,#debugger .debugger-check{position:relative;display:inline-block;vertical-align:baseline;margin-right:4px;width:12px;height:12px;border:1px solid #c4cbd2;border-radius:12px}#debugger .debugger-check-empty{border-color:#909090}#debugger .debugger-check:before{content:\'\';display:block;position:absolute;top:50%;left:50%;margin:-7px 0 0 -4px;height:4px;width:10px;border:solid #888;border-width:0 0 3px 3px;-webkit-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-ms-transform:rotate(-45deg);-o-transform:rotate(-45deg);transform:rotate(-45deg)}#debugger .sidebar li:hover .debugger-check:before{border-color:#eee}#debugger .logs li .message{color:#444;width:75%;border-left:solid 1px #ccc;float:right;padding-left:12px;padding-right:60px;white-space:pre-wrap}#debugger .logs li:hover .level{opacity:1}#debugger .level-filter{background:#F4F4F4;font-size:0;border-bottom:solid 1px #B6B5B5}#debugger .level-filter li{display:inline-block;color:#555;text-transform:capitalize;text-shadow:0 1px 0 #ececec;font-size:12px;padding:5px 20px 3px;cursor:pointer;text-rendering:optimizeLegibility;border-bottom:solid 5px transparent;background:#F4F4F4;position:relative;width:auto;z-index:auto;border:0;border-radius:0}#debugger .level-filter li.active{text-shadow:0 0 rgba(0,0,0,.5);background:#F4F4F4;color:#4C4B4B}#debugger .level-filter li.active._all{border-bottom:solid 5px #A362BC}#debugger .level-filter li.active.error{border-bottom:solid 5px #BA322E}#debugger .level-filter li.active.info{border-bottom:solid 5px #2986C4}#debugger .level-filter li.active.warn{border-bottom:solid 5px #ED9C24}#debugger .level-filter li.active.log{border-bottom:solid 5px #8AC334}#debugger .level-filter li._all:hover{border-bottom:solid 5px #B47AC8}#debugger .level-filter li.error:hover{border-bottom:solid 5px #F24441}#debugger .level-filter li.info:hover{border-bottom:solid 5px #5E9BCE}#debugger .level-filter li.warn:hover{border-bottom:solid 5px #EFC46E}#debugger .level-filter li.log:hover{border-bottom:solid 5px #ACD86D}#debugger .level-filter li.search-data,#debugger .level-filter li.clear-data{float:right}#debugger .level-filter li.search-data>input{border-radius:4px;height:17px;outline:0}#debugger .level-filter li.clear-data:hover{border-bottom:solid 5px #999}#debugger span.json-key{color:#881391;font-size:10px;line-height:11px}#debugger span.json-value{color:#1C00D5;font-size:10px;line-height:11px}#debugger span.json-string{color:#C41A16;font-size:10px;line-height:11px}</style>')}])}({},function(){return this}());